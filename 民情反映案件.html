<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>民情案件管理系统</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            padding-top: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--dark-color));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            transition: transform 0.3s;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0 !important;
            padding: 15px 20px;
            font-weight: 600;
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: 600;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #27ae60;
            border: none;
        }
        
        .table thead {
            background-color: var(--primary-color);
            color: white;
        }
        
        .table th {
            border: none;
        }
        
        .table td {
            vertical-align: middle;
        }
        
        .form-control, .form-select {
            border-radius: 5px;
            border: 1px solid #ddd;
            padding: 10px;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        .search-section {
            background-color: var(--light-color);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-pending {
            background-color: #f39c12;
            color: white;
        }
        
        .status-completed {
            background-color: #27ae60;
            color: white;
        }
        
        .status-rejected {
            background-color: #e74c3c;
            color: white;
        }
        
        .result-count {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .action-buttons button {
            margin-right: 5px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .tab-content {
            padding: 20px 0;
        }
        
        .nav-tabs .nav-link.active {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .nav-tabs .nav-link {
            color: var(--primary-color);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header text-center">
            <h1><i class="fas fa-clipboard-list me-2"></i>原民會民情案件管理</h1>
            <p class="lead">案件新增、查詢與管理系統</p>
        </div>
        
        <ul class="nav nav-tabs mb-4" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="add-tab" data-bs-toggle="tab" data-bs-target="#add" type="button" role="tab" aria-controls="add" aria-selected="true">新增案件</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="search-tab" data-bs-toggle="tab" data-bs-target="#search" type="button" role="tab" aria-controls="search" aria-selected="false">查詢案件</button>
            </li>
        </ul>
        
        <div class="tab-content" id="myTabContent">
            <!-- 新增案件表單 -->
            <div class="tab-pane fade show active" id="add" role="tabpanel" aria-labelledby="add-tab">
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-plus-circle me-2"></i>新增民情案件
                    </div>
                    <div class="card-body">
                        <form id="caseForm">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="caseName" class="form-label">反映案件名稱</label>
                                    <input type="text" class="form-control" id="caseName" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="reflectDate" class="form-label">反映日期</label>
                                    <input type="date" class="form-control" id="reflectDate" required>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="reflectTarget" class="form-label">反映對象</label>
                                    <select class="form-select" id="reflectTarget" required>
                                        <option value="">請選擇反映對象</option>
                                        <option value="總統訪視">總統訪視</option>
                                        <option value="立委陳情">立委陳情</option>
                                        <option value="其他">其他</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="reflectPerson" class="form-label">反映人</label>
                                    <input type="text" class="form-control" id="reflectPerson" required>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-12">
                                    <label for="caseReason" class="form-label">反映事由</label>
                                    <textarea class="form-control" id="caseReason" rows="3" required></textarea>
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="plannedDate" class="form-label">預定勘查日期</label>
                                    <input type="date" class="form-control" id="plannedDate">
                                </div>
                                <div class="col-md-6">
                                    <label for="actualDate" class="form-label">實際勘查日期</label>
                                    <input type="date" class="form-control" id="actualDate">
                                </div>
                            </div>
                            
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="investigationResult" class="form-label">勘查結果</label>
                                    <select class="form-select" id="investigationResult">
                                        <option value="">請選擇勘查結果</option>
                                        <option value="非本會權責">非本會權責</option>
                                        <option value="不符公眾利益">不符公眾利益</option>
                                        <option value="納入審議">納入審議</option>
                                        <option value="其他">其他</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="currentStatus" class="form-label">目前辦理現況</label>
                                    <select class="form-select" id="currentStatus">
                                        <option value="">請選擇辦理現況</option>
                                        <option value="已發包">已發包</option>
                                        <option value="審核中">審核中</option>
                                        <option value="規劃中">規劃中</option>
                                        <option value="已完成">已完成</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                                <button type="reset" class="btn btn-secondary me-md-2">清除</button>
                                <button type="submit" class="btn btn-primary">新增案件</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- 查詢案件區域 -->
            <div class="tab-pane fade" id="search" role="tabpanel" aria-labelledby="search-tab">
                <div class="search-section">
                    <h4><i class="fas fa-search me-2"></i>案件查詢</h4>
                    <form id="searchForm">
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="searchYear" class="form-label">年度</label>
                                <select class="form-select" id="searchYear">
                                    <option value="">請選擇年度</option>
                                    <option value="114">114年</option>
                                    <option value="113">113年</option>
                                    <option value="112">112年</option>
                                    <option value="111">111年</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="searchKeyword" class="form-label">關鍵字查詢</label>
                                <input type="text" class="form-control" id="searchKeyword" placeholder="例如：孔文吉">
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <button type="submit" class="btn btn-primary w-100">查詢</button>
                            </div>
                        </div>
                    </form>
                </div>
                
                <div class="result-count" id="resultCount">查詢結果：共 0 筆資料</div>
                
                <div class="card">
                    <div class="card-header">
                        <i class="fas fa-list me-2"></i>查詢結果
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="caseTable">
                                <thead>
                                    <tr>
                                        <th>項次</th>
                                        <th>反映人</th>
                                        <th>反映對象</th>
                                        <th>反映日期</th>
                                        <th>反映事由</th>
                                        <th>預定勘查日期</th>
                                        <th>實際勘查日期</th>
                                        <th>勘查結果</th>
                                        <th>目前辦理現況</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody id="caseTableBody">
                                    <!-- 查詢結果將動態生成在這裡 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 示例數據
        let cases = [
            {
                id: 1,
                caseName: "特色道路改善計畫",
                reflectDate: "114-05-15",
                reflectTarget: "立委陳情",
                reflectPerson: "張大明",
                caseReason: "重要觀光部落，提升道路周邊特色",
                plannedDate: "114-05-25",
                actualDate: "114-05-26",
                investigationResult: "已核定",
                currentStatus: "尚未發包"
            },
            {
                id: 2,
                caseName: "部落防減災提升計畫",
                reflectDate: "114-04-10",
                reflectTarget: "總統訪視",
                reflectPerson: "李美麗",
                caseReason: "部落邊坡滑動，加強邊坡穩定",
                plannedDate: "114-04-20",
                actualDate: "114-04-22",
                investigationResult: "納入審議",
                currentStatus: "審議中"
            }
        ];
        
        // 表單提交事件 - 新增案件
        document.getElementById('caseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 獲取表單數據
            const caseData = {
                id: cases.length + 1,
                caseName: document.getElementById('caseName').value,
                reflectDate: document.getElementById('reflectDate').value,
                reflectTarget: document.getElementById('reflectTarget').value,
                reflectPerson: document.getElementById('reflectPerson').value,
                caseReason: document.getElementById('caseReason').value,
                plannedDate: document.getElementById('plannedDate').value,
                actualDate: document.getElementById('actualDate').value,
                investigationResult: document.getElementById('investigationResult').value,
                currentStatus: document.getElementById('currentStatus').value
            };
            
            // 添加到案例數組
            cases.push(caseData);
            
            // 重置表單
            document.getElementById('caseForm').reset();
            
            // 顯示成功消息
            alert('案件新增成功！');
            
            // 切換到查詢標籤頁
            const searchTab = new bootstrap.Tab(document.getElementById('search-tab'));
            searchTab.show();
            
            // 更新查詢結果
            updateSearchResults();
        });
        
        // 查詢表單提交事件
        document.getElementById('searchForm').addEventListener('submit', function(e) {
            e.preventDefault();
            updateSearchResults();
        });
        
        // 更新查詢結果
        function updateSearchResults() {
            const yearFilter = document.getElementById('searchYear').value;
            const keywordFilter = document.getElementById('searchKeyword').value.toLowerCase();
            
            // 過濾案例
            const filteredCases = cases.filter(caseItem => {
                const matchesYear = !yearFilter || caseItem.reflectDate.startsWith(yearFilter);
                const matchesKeyword = !keywordFilter || 
                    caseItem.caseName.toLowerCase().includes(keywordFilter) ||
                    caseItem.reflectPerson.toLowerCase().includes(keywordFilter) ||
                    caseItem.caseReason.toLowerCase().includes(keywordFilter);
                
                return matchesYear && matchesKeyword;
            });
            
            // 更新結果計數
            document.getElementById('resultCount').textContent = `查詢結果：共 ${filteredCases.length} 筆資料`;
            
            // 更新表格
            const tableBody = document.getElementById('caseTableBody');
            tableBody.innerHTML = '';
            
            if (filteredCases.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" class="text-center">沒有找到符合條件的案件</td></tr>';
            } else {
                filteredCases.forEach((caseItem, index) => {
                    const row = document.createElement('tr');
                    
                    // 根據狀態添加類別
                    if (caseItem.currentStatus === '已完成') {
                        row.classList.add('table-success');
                    } else if (caseItem.currentStatus === '規劃中') {
                        row.classList.add('table-warning');
                    }
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${caseItem.reflectPerson}</td>
                        <td>${caseItem.reflectTarget}</td>
                        <td>${formatDate(caseItem.reflectDate)}</td>
                        <td>${caseItem.caseReason.substring(0, 30)}${caseItem.caseReason.length > 30 ? '...' : ''}</td>
                        <td>${formatDate(caseItem.plannedDate)}</td>
                        <td>${formatDate(caseItem.actualDate)}</td>
                        <td><span class="status-badge ${getStatusClass(caseItem.investigationResult)}">${caseItem.investigationResult}</span></td>
                        <td>${caseItem.currentStatus}</td>
                        <td class="action-buttons">
                            <button class="btn btn-sm btn-outline-primary" onclick="viewCase(${caseItem.id})"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-outline-warning" onclick="editCase(${caseItem.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteCase(${caseItem.id})"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
        }
        
        // 格式化日期
        function formatDate(dateString) {
            if (!dateString) return '-';
            const date = new Date(dateString);
            return `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2, '0')}-${date.getDate().toString().padStart(2, '0')}`;
        }
        
        // 獲取狀態類別
        function getStatusClass(status) {
            switch(status) {
                case '納入審議': return 'status-pending';
                case '非本會權責': return 'status-rejected';
                case '不符公眾利益': return 'status-rejected';
                default: return 'status-completed';
            }
        }
        
        // 查看案件詳情
        function viewCase(id) {
            const caseItem = cases.find(c => c.id === id);
            if (caseItem) {
                alert(`案件詳情：\n案件名稱：${caseItem.caseName}\n反映人：${caseItem.reflectPerson}\n反映事由：${caseItem.caseReason}`);
            }
        }
        
        // 編輯案件
        function editCase(id) {
            alert(`編輯案件 ID: ${id} - 此功能需後端支持`);
        }
        
        // 刪除案件
        function deleteCase(id) {
            if (confirm('確定要刪除此案件嗎？')) {
                cases = cases.filter(c => c.id !== id);
                updateSearchResults();
                alert('案件已刪除');
            }
        }
        
        // 初始化頁面時顯示示例數據
        document.addEventListener('DOMContentLoaded', function() {
            updateSearchResults();
        });
    </script>
</body>
</html>